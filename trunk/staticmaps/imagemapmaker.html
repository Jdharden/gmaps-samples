<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>Google Maps JavaScript API Example: Simple Polygon</title>
    <script src="http://maps.google.com/maps?file=api&amp;v=2.x&amp;key=ABQIAAAA-O3c-Om9OcvXMOJXreXHAxQGj0PqsCtxKvarsoS-iqLdqZSKfxS27kJqGZajBjvuzOBLizi931BUow"
      type="text/javascript"></script>
    <script src="states2.js" type="text/javascript"></script>
    <script src="http://www.netzgesta.de/mapper/mapper.js"></script>
    <script type="text/javascript">
    var map;
    var polys = [];

    function initialize() {
      if (GBrowserIsCompatible()) {
        map = new GMap2(document.getElementById("map_canvas"));
        map.setCenter(new GLatLng(42, -99), 3);
        map.addControl(new GSmallMapControl());
       	for (stateCode in states) { 
          var polygon = createPoly(stateCode);
          polys.push(polygon);
          map.addOverlay(polygon);
        }
        createImageMap();
        //createStaticMap();
        addMapper();
      }
    }   
  
    function createPoly(stateCode) {
       var latlngs = [];
       for (var i = 0; i < states[stateCode].length; i++) {
         var latlng = states[stateCode][i];
         latlngs.push(new GLatLng(latlng[0], latlng[1]));
       }
       var polygon = new GPolygon(latlngs, "#f33f00", 0, 0, "#ff0000", 0.01);
       polygon.stateCode = stateCode;
       return polygon;
    }

    function createStaticMap() {
      var staticMap = document.createElement("img");
      staticMap.src = "http://maps.google.com/staticmap?center=" + map.getCenter().toUrlValue(6) + "&zoom=" + map.getZoom() + "&size=" + map.getSize().width + "x" + map.getSize().height + "&key=ABQIAAAAjU0EJWnWPMv7oQ-jjS7dYxSPW5CJgpdgO_s4yyMovOaVh_KvvhSfpvagV18eOyDWu7VytS6Bi1CWxw";
      staticMap.usemap = "#states";
      staticMap.width =  map.getSize().width;
      staticMap.height = map.getSize().height;
      staticMap.className = "mapper";
      document.body.appendChild(staticMap);
    }

    function createImageMap() {
      var imageMap = document.createElement("map");
      imageMap.name = "states";
      for (var i = 0; i < polys.length; i++) {
        var coords = [];
        for (var j = 0; j < polys[i].getVertexCount(); j++) {
          var pixel = map.fromLatLngToContainerPixel(polys[i].getVertex(j));
          coords.push(pixel.x + "," + pixel.y);
        }
        var area = document.createElement("area");
        area.shape = "polygon"; 
        area.coords = coords.join(",");
        area.href = "http://www.google.com/search?q=" + polys[i].stateCode + "+state+code";
        imageMap.appendChild(area);    
      }
      document.body.appendChild(imageMap);   
    }
    </script>
  </head>

  <body onload="initialize()" onunload="GUnload()">
    <div id="map_canvas" style="width: 500px; height: 300px"></div>
<div>
<img class="mapper" width="500" height="300" src="http://maps.google.com/staticmap?center=42,-99&zoom=3&size=500x300&key=ABQIAAAAzr2EBOXUKnm_jVnk0OJI7xSsTL4WIgxhMZ0ZK_kHjwHeQuOD4xQJpBVbSrqNn69S6DOTv203MQ5ufA" usemap="#states"/>    
</div>
  </body>
</html>

